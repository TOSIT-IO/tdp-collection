# Copyright 2022 TOSIT.IO
# SPDX-License-Identifier: Apache-2.0

---
- name: Template firewalld ipsets from Ansible groups
  template:
    src: firewalld-ipset.xml.j2
    dest: "/etc/firewalld/ipsets/{{ name }}.xml"
    lstrip_blocks: yes
  vars:
    name: "{{ item }}"
    short: "{{ item }} Ansible group"
    hosts: "{{ groups[item] }}"
  loop: "{{ ansible_groups }}"

- name: Reload firewalld
  service:
    name: firewalld
    state: reloaded
  when: firewall_enabled
