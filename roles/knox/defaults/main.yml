---
# Knox version
knox_release: knox-1.0.0-TDP-0.1.0-SNAPSHOT #TODO change knox release in pom.xml and here
knox_dist_file: "{{ knox_release }}.tar.gz"

knoxshell_release: knoxshell-1.0.0-TDP-0.1.0-SNAPSHOT
knoxshell_dist_file: "{{ knoxshell_release }}.tar.gz"

# Knox users and group
knox_user: knox
knox_group: hadoop

# Knox installation directory
knox_root_dir: /opt/tdp
knox_install_dir: "{{ knox_root_dir }}/knox"
knoxshell_install_dir: "{{ knox_root_dir }}/knoxshell"

# Knox PID directory
knox_pid_dir: /var/run/knox

# Knox logging directory
knox_log_dir: /var/log/knox

# Knox configuration directory
knox_conf_dir: /etc/knox/conf
knox_data_dir: /var/lib/knox

# Knox Keystore directory
knox_keystore_dir: "{{ knox_data_dir }}/data/security/keystores"

# SSL Keystore and Truststore
knox_keystore_location: "{{ knox_keystore_dir }}/gateway.jks"
knox_keystore_password: Keystore123!
knox_truststore_location: "{{ knox_keystore_dir }}/truststore.jks"
knox_truststore_password: Truststore123!

# Hadoop configuration directory
hadoop_conf_dir: /etc/hadoop/conf

# Gateway-site
gateway_site:
  gateway.port: 8443
  gateway.path: gateway
  gateway.hadoop.kerberos.secured: "true"
  java.security.krb5.conf: /etc/krb5.conf
  java.security.auth.login.config: "{{ knox_conf_dir }}/krb5JAASLogin.conf"
  sun.security.krb5.debug: "true"
  gateway.deployment.dir: "{{ knox_data_dir }}/data/deployments"
  gateway.security.dir: "{{ knox_data_dir }}/data/security"
  gateway.data.dir: "{{ knox_data_dir }}/data"
  gateway.hadoop.conf.dir: "{{ knox_conf_dir }}"
  gateway.cluster.config.monitor.ambari.enabled: "false"

# Service restart policies
knox_restart: "no"

# Ranger Knox properties
ranger_knox_release: ranger-2.0.1-TDP-0.1.0-SNAPSHOT-knox-plugin
ranger_knox_dist_file: "{{ ranger_knox_release }}.tar.gz"
ranger_knox_install_dir: "{{ knox_root_dir }}/ranger-knox-plugin"
ranger_knox_install_properties:
  audit_hdfs: hdfs://mycluster
  POLICY_MGR_URL: https://{{ groups['ranger_admin'][0] | tosit.tdp.access_fqdn(hostvars) }}:6182
  REPOSITORY_NAME: knox-tdp
ranger_knox_service_properties:
  knox_url: https://{{ groups['knox'][0] | tosit.tdp.access_fqdn(hostvars) }}:8443
  common_name_certificate: |
          {{ groups['knox'] | 
            map('tosit.tdp.access_fqdn', hostvars) |
            list |
            join(',') | trim }}
